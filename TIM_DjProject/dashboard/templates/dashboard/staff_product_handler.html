{% extends "base.html" %}

{% block title %}Products Form{% endblock %}

{% block content %}
<div class="container mt-4">
    <h3>RFID Product Management</h3>

    <form method="POST">
        {% csrf_token %}

        <!-- Action Selection -->
        <div class="form-group mb-3">
            <label>Action:</label><br>
            <label class="font-weight-light mr-3">
                <input type="radio" name="action" value="add" checked> Add Product
            </label>
            <label class="font-weight-light">
                <input type="radio" name="action" value="deliver"> Mark as Delivered
            </label>
        </div>

        <!-- RFID Input -->
        <div class="form-group mb-3">
            <label for="rfid">RFID Tag:</label>
            <input type="text" name="rfid_tag" class="form-control" value="{{ rfid_prefill }}" required>
        </div>

        <!-- Product Info for Adding -->
        <div id="product-info-fields">
            <div class="form-group mb-3">
                <label for="name">Product Name:</label>
                <input type="text" name="name" id="name" class="form-control">
            </div>

            <div class="form-group mb-3">
                <label for="client">Client Username:</label>
                <input type="text" name="client" id="client" class="form-control">
            </div>

            <div class="form-group mb-3">
                <label for="vehicle">Vehicle Plate Number (optional):</label>
                <input type="text" name="vehicle" id="vehicle" class="form-control">
            </div>

            <div class="form-group mb-3">
                <label for="warehouse">Warehouse Location (optional):</label>
                <input type="text" name="warehouse" id="warehouse" class="form-control">
            </div>
        </div>

        <button type="submit" class="btn btn-primary mt-2">Submit</button>
    </form>

    {% if message %}
        <div class="alert alert-info mt-4">{{ message }}</div>
    {% endif %}
</div>

<script>
// Optional: Hide product fields if "Deliver" is selected
document.querySelectorAll('input[name="action"]').forEach(radio => {
    radio.addEventListener('change', () => {
        const productFields = document.getElementById("product-info-fields");
        if (document.querySelector('input[name="action"]:checked').value === 'deliver') {
            productFields.style.display = "none";
        } else {
            productFields.style.display = "block";
        }
    });
});
</script>
{% endblock %}
